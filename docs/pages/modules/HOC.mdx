# Higher Order Function: `withDatamint`

The `withDatamint` function is a higher-order function provided by the Datamint library. It's designed to simplify the process of setting up and tearing down a Datamint client for your tests.

## Usage

Here's a basic example of how to use `withDatamint`:

```typescript
import { withDatamint } from "@datamint/core/hoc/withDatamint";
import { DatabaseType } from "@datamint/core/enums";
import { DatamintClient } from "@datamint/core/database";

const { setup, teardown, run } = withDatamint(
  DatabaseType.MYSQL,
  { name: "my_database", user: "root", password: "password" },
  (client: DatamintClient) => {
    it("should run a test", async () => {
      // Use the client in your test
      // ...
    });
  }
);

beforeAll(async () => await setup());
afterAll(async () => await teardown());
run();
```

In this example, `withDatamint` is used to create a Datamint client for a MySQL database. The `setup` and `teardown` functions are used to start and stop the client, and the run function is used to run the test suite.

## Using `withDatamint` with Different Testing Frameworks

The `withDatamint` function can be used with any testing framework that supports setup and teardown hooks. Here's how you can use it with some popular testing frameworks:

### Jest

```typescript
describe("withDatamint", () => {
  const { setup, teardown, run } = withDatamint(
    DatabaseType.MYSQL,
    { name: "my_database", user: "root", password: "password" },
    (client: DatamintClient) => {
      test("should run a test", async () => {
        // Use the client in your test
        // ...
      });
    }
  );

  beforeAll(async () => await setup());
  afterAll(async () => await teardown());
  run();
});
```

### Mocha

```typescript
describe("withDatamint", () => {
  const { setup, teardown, run } = withDatamint(
    DatabaseType.MYSQL,
    { name: "my_database", user: "root", password: "password" },
    (client: DatamintClient) => {
      it("should run a test", async () => {
        // Use the client in your test
        // ...
      });
    }
  );

  beforeAll(async () => await setup());
  afterAll(async () => await teardown());
  run();
});
```

### Jasmine

```typescript
describe("withDatamint", () => {
  const { setup, teardown, run } = withDatamint(
    DatabaseType.MYSQL,
    { name: "my_database", user: "root", password: "password" },
    (client: DatamintClient) => {
      it("should run a test", async () => {
        // Use the client in your test
        // ...
      });
    }
  );

  beforeAll(async () => await setup());
  afterAll(async () => await teardown());
  run();
});
```

### AVA

AVA doesn't have built-in beforeAll and afterAll hooks, but you can use the `test.before` and `test.after` hooks to achieve a similar effect.

```typescript
import test from "ava";
import { withDatamint } from "./withDatamint";
import { DatabaseType } from "../enums";
import { DatamintClient } from "src/core/database";

const { setup, teardown, run } = withDatamint(
  DatabaseType.MYSQL,
  { name: "my_database", user: "root", password: "password" },
  (client: DatamintClient) => {
    test("should run a test", async (t) => {
      // Use the client in your test
      // ...
    });
  }
);

test.before(async () => {
  await setup();
});

test.after.always(async () => {
  await teardown();
});

run();
```

### Tap

Tap has `beforeEach` and `afterEach` hooks, but you can use a variable to check if the setup and teardown functions have been called.

```typescript
import tap from "tap";
import { withDatamint } from "./withDatamint";
import { DatabaseType } from "../enums";
import { DatamintClient } from "src/core/database";

let setupDone = false;
let teardownDone = false;

const { setup, teardown, run } = withDatamint(
  DatabaseType.MYSQL,
  { name: "my_database", user: "root", password: "password" },
  (client: DatamintClient) => {
    tap.test("should run a test", async (t) => {
      if (!setupDone) {
        await setup();
        setupDone = true;
      }

      // Use the client in your test
      // ...

      if (!teardownDone) {
        await teardown();
        teardownDone = true;
      }
    });
  }
);

run();
```

For more information on how to use `withDatamint` with other testing frameworks, please refer to the [API documentation]().
